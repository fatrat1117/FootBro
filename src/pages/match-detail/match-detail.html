<ion-header #pageHeader>
  <ion-toolbar>
    <ion-buttons left>
      <button (tap)="dismiss()" color='danger' ion-button icon-only clear>
        <ion-icon name="md-close"></ion-icon>
      </button>
    </ion-buttons>
    <ion-title>{{'matchInfo' | trans}}</ion-title>
    <ion-buttons right>
      <button *ngIf='canShowEdit()' color='primaryYellow' (tap)="edit()" ion-button icon-only clear>
          <ion-icon name="md-create"></ion-icon>
      </button>
      <sb-share-button></sb-share-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>


<ion-content #matchDetailContent [ngSwitch]="matchSegments" style="width: 100%; height: 100%" no-bounce>

  <ion-row class="match-detail-menu" no-padding>
    <ion-col class="menu-col" center width-33>
      <div full color="dark" class="team-name flex-direction-column">
        <img [src]="match?.home?.logo" class="team-logo inline-flex-center">
        <p class="inline-flex-center">{{match?.home?.name}}</p>
      </div>
    </ion-col>
    <ion-col class="menu-col" center width-33>
      <div full color="dark" class="group-message flex-direction-column">
        <ion-icon name="megaphone" class="inline-flex-center"></ion-icon>
        <p class="inline-flex-center">{{'informAll' | trans}}</p>
      </div>
    </ion-col>
    <ion-col class="menu-col" center width-33>
      <div full color="dark" class="opponent flex-direction-column">
        <img [src]="match?.away?.logo" class="opponent-logo inline-flex-center">
        <p class="inline-flex-center">{{match?.away?.name}}</p>
      </div>
    </ion-col>
  </ion-row>

  <ion-segment [ngModel]="matchSegments" (ngModelChange)="segmentChange($event)" mode="md">
    <ion-segment-button value="info">
      {{'Info' | trans}}
    </ion-segment-button>
    <ion-segment-button *ngIf='canShowSquadSegment()' value="squad">
      {{'squad' | trans}}
    </ion-segment-button>
    <ion-segment-button *ngIf='canShowPlayersSegment()' value="players">
      {{'Players' | trans}}
    </ion-segment-button>
  </ion-segment>
<div class="content-all" *ngSwitchCase="'info'" style="width: 100%; height: 100%">
<ion-list no-lines class="content-list" center>
  <result-score [upcomingMatch]="match" [hostPageName]="currPageName"></result-score>


  <ion-item class="time-title">
    <ion-icon name="time"></ion-icon>
    <div class="time-content"> {{match?.time | date:'MM-dd EEEE  H:mm'}}</div>
  </ion-item>
  <ion-item class="map-title" (tap)="navigateToField()">
    <ion-icon name="navigate" color="iPrimary"></ion-icon>
    {{match?.location?.name}}
    <p>{{match?.location?.address}}</p>
  </ion-item>

  <!--<ion-item class="time-title">-->
    <!--<ion-icon name="time"></ion-icon>-->
    <!--<div class="time-content"> {{match?.time | date:'MM-dd EEEE  H:mm'}}</div>-->
  <!--</ion-item>-->

</ion-list>

<div *ngIf="canShowEnroll()">
  <ion-list>
    <ion-item-divider>{{'participants' | trans}}({{attendances.length}})</ion-item-divider>
    <ion-item *ngIf="attendances.length" text-wrap>
      <div *ngFor="let p of attendances" class="avatar-top">
        <img [src]="p?.photo" />
        <p>{{ p?.name }}</p>
      </div>
    </ion-item>
    <ion-item-divider>{{'applyleave' | trans}}({{absences.length}})</ion-item-divider>
    <ion-item *ngIf="absences.length" text-wrap>
      <div *ngFor="let p of absences" class="avatar-top">
        <img [src]="p?.photo" />
        <p>{{ p?.name }}</p>
      </div>
    </ion-item>
    <ion-item-divider>{{'TBD' | trans}}({{TBDs.length}})</ion-item-divider>
    <ion-item *ngIf="TBDs.length" text-wrap>
      <div *ngFor="let p of TBDs" class="avatar-top">
        <img [src]="p?.photo" />
        <p>{{ p?.name }}</p>
      </div>
    </ion-item>
  </ion-list>
  <ion-row padding-horizontal>
    <ion-col text-center>
      <button ion-button block color="secondary" [disabled]="getDisabled(2)" small (click)="TBDMatch()">
        <ion-icon name="checkmark"></ion-icon>
        {{'TBD' | trans}}
      </button>
    </ion-col>
    <ion-col text-center>
      <button ion-button block color="secondary" [disabled]="getDisabled(0)" small (click)="absentMatch()">
        <ion-icon name="checkmark"></ion-icon>
        {{'applyleave' | trans}}
      </button>
    </ion-col>
    <ion-col text-center>
      <button ion-button color="danger" [disabled]="getDisabled(1)" small (click)="attendMatch()">
        <ion-icon name="close"></ion-icon>
        {{'Going' | trans}}
      </button>
    </ion-col>
  </ion-row>
</div>
<button *ngIf='canShowDelete()' (tap)="deleteMatch()" color='danger' ion-button block>{{'deletematch' | trans}}</button>
</div>

<div class="content-all" *ngSwitchCase="'squad'">
  <page-squad #squadCtrl [settings]="squadSettings" style="width: 100%; height: 100%"></page-squad>
</div>

<div class="content-all" *ngSwitchCase="'players'">
  <button *ngIf='canShowRate()' (tap)="openRatePlayersPage()" ion-button block>
          {{'rateplayers' | trans}}
      </button>
  <no-record *ngIf="statCategories.length <= 0" message="{{'searchMatchPageNoRecord' | trans}}"></no-record>
  <div *ngIf="statCategories.length > 0">
    <div class="left-scrollview matches-date-tab-col" [ngStyle]="{'height.px': getMatchDetailScrollHeight()}">
      <ion-list class="date-tab-list">
        <ion-item *ngFor="let cat of statCategories;let i = index;" #list_item [id]="'matches-scroll-target-'+i" (tap)='showStat(cat)'
          [style.background]="selectedCat === cat ? '#20bd16' : '#373e4c'" [style.color]="selectedCat === cat ? '#ffffff' : '#93ABC5'">
          <div class="date-inner">
            {{cat | trans}}
          </div>
        </ion-item>
      </ion-list>
    </div>

    <div class="right-scrollview matches-match-info-col" *ngIf='selectedStats' [ngStyle]="{'height.px': getMatchDetailScrollHeight()}">
      <ion-grid class="right-view-grid">
        <ion-row class="header-title">
          <!--<ion-col width-10>{{'Rank' | trans}}</ion-col>-->
          <ion-col width-20></ion-col>
          <ion-col width-30 class="flex-width-30">{{'Player' | trans}}</ion-col>
          <ion-col width-30 class="flex-width-30">{{'Team' | trans}}</ion-col>
          <ion-col width-20 text-center>{{'total' | trans}}</ion-col>
        </ion-row>
        <ion-row *ngFor="let stat of selectedStats;let i=index" class="playerStats">
          <ion-col width-20 class="rank">

            <ion-label no-margin>{{i+1}}</ion-label>
            <ion-avatar item-left>
              <img [src]="stat.player?.photo" />
            </ion-avatar>
          </ion-col>
          <ion-col width-30 no-margin class="flex-width-30">
            <ion-item>
              {{stat.player?.name}}
            </ion-item>
          </ion-col>
          <ion-col width-30 class="flex-width-30">
            <ion-label no-margin>{{stat.teamName}}</ion-label>
          </ion-col>
          <ion-col width-20>
            <ion-label no-margin text-center>{{stat.val}}</ion-label>
          </ion-col>
        </ion-row>
      </ion-grid>
    </div>
  </div>
</div>
</ion-content>
